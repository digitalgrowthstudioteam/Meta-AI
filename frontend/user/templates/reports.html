{% extends "user/templates/user_base.html" %}

{% block title %}Reports | Digital Growth Studio{% endblock %}

{% block page_title %}
Reports
{% endblock %}

{% block content %}

<div class="audience-container">

    <!-- ================= AI Explainability Banner ================= -->
    <div class="ai-info-banner">
        <strong>Performance & AI Reports</strong>
        <p>
            Reports provide read-only visibility into campaign performance,
            AI actions, and outcome trends.
        </p>
    </div>

    <!-- ================= Report Summary Cards ================= -->
    <div class="audience-grid">

        <!-- Total Campaigns -->
        <div class="audience-card info">
            <h3>Total Campaigns</h3>
            <p class="audience-metric" id="total-campaigns">—</p>
            <p class="audience-note">
                All campaigns fetched from connected Meta ad accounts.
            </p>
            <span class="confidence medium">Live Data</span>
        </div>

        <!-- AI Active Campaigns -->
        <div class="audience-card positive">
            <h3>AI-Active Campaigns</h3>
            <p class="audience-metric" id="ai-active-campaigns">—</p>
            <p class="audience-note">
                Campaigns currently optimized by AI.
            </p>
            <span class="confidence high">High Confidence</span>
        </div>

        <!-- Lead vs Sales -->
        <div class="audience-card warning">
            <h3>Lead vs Sales Split</h3>
            <p class="audience-metric">
                <span id="lead-campaigns">—</span> Leads ·
                <span id="sales-campaigns">—</span> Sales
            </p>
            <p class="audience-note">
                Objective distribution across AI-active campaigns.
            </p>
            <span class="confidence medium">Derived</span>
        </div>

    </div>

    <!-- ================= Detailed Reports Section ================= -->
    <div class="audience-section">
        <h2 class="section-title">Detailed Reports</h2>

        <div class="empty-state">
            <p>More detailed reports coming soon.</p>
            <p class="muted">
                This section will include campaign-level and time-based insights.
            </p>
        </div>
    </div>

</div>

<!-- ================= Reports API Integration ================= -->
<script>
(async function loadReportsOverview() {
    try {
        const response = await fetch("/api/reports/overview");
        if (!response.ok) {
            throw new Error("Failed to load reports");
        }

        const result = await response.json();
        const data = result.data || {};

        document.getElementById("total-campaigns").innerText =
            data.total_campaigns ?? "0";

        document.getElementById("ai-active-campaigns").innerText =
            data.ai_active_campaigns ?? "0";

        document.getElementById("lead-campaigns").innerText =
            data.lead_campaigns ?? "0";

        document.getElementById("sales-campaigns").innerText =
            data.sales_campaigns ?? "0";

    } catch (error) {
        console.error("Reports load error:", error);
    }
})();
</script>

{% endblock %}
