<!DOCTYPE html>
<html>
<head>
  <title>Subscription Test UI</title>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
  <h2>Test LIVE Subscription</h2>
  <button id="btn">Start Subscription</button>

<script>
document.getElementById("btn").onclick = async () => {

  const resp = await fetch("https://meta-ai.digitalgrowthstudio.in/api/billing/subscription/recurring?plan_id=2", {
    method: "POST",
    credentials: "include", // <--- sends session cookie
  });

  console.log("STATUS:", resp.status);

  if (!resp.ok) {
    const tx = await resp.text();
    alert("Error " + resp.status + ": " + tx);
    return;
  }

  const data = await resp.json();
  console.log(data);

  const options = {
    key: data.key,
    subscription_id: data.razorpay_subscription_id,
    name: "Meta AI",
    description: data.plan_name,
    handler: function (response) {
      alert("SUCCESS: " + JSON.stringify(response));
    }
  };

  new Razorpay(options).open();
};
</script>
</body>
</html>
